<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles/global.css">
    <link rel="stylesheet" href="./styles/header.css">
    <link rel="stylesheet" href="./styles/sidebar.css">
    <link rel="stylesheet" href="./styles/addtask.css">
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon-16x16.png">
    <link rel="manifest" href="./assets/site.webmanifest">
    <title>Add Task</title>
</head>

<body>

    <div id="page-root" aria-hidden="false">

        <header role="banner">
            <div w3-include-html="./header.html"></div>
        </header>

        <div class="layout" role="presentation">

            <aside role="complementary" aria-label="Sidebar navigation">
                <div w3-include-html="./sidebar.html"></div>
            </aside>

            <main role="main" aria-labelledby="page-title">
                <h1 id="page-title" class="visually-hidden">Add Task</h1>
                <div class="main-container" role="form" aria-describedby="form-hint">
                    <p id="form-hint" class="visually-hidden">
                        Required fields are marked and must be filled before submitting the task.
                    </p>

                    <!-- TITLE -->
                    <div class="title-container">
                        <label for="task-title" class="visually-hidden">Title</label>
                        <input type="text" id="task-title" class="title-input" placeholder="Enter a title" required
                            aria-required="true" aria-describedby="title-error">
                        <span id="title-error" class="error-message" role="alert">This field is required</span>
                    </div>

                    <!-- DESCRIPTION -->
                    <div class="description-container">
                        <div class="description-header">
                            <span class="desc-title" id="desc-label">Description</span>
                            <span class="desc-optional">(optional)</span>
                        </div>
                        <textarea class="description-input" placeholder="Enter a description"
                            aria-labelledby="desc-label"></textarea>
                    </div>

                    <!-- DUE DATE -->
                    <div class="due-date-container">
                        <div class="due-date-header" id="due-date-label">Due date</div>
                        <div class="due-date-content">
                            <label for="due-date-input" class="visually-hidden">Select due date</label>
                            <input type="date" id="due-date-input" class="due-date-input" required aria-required="true"
                                aria-describedby="due-date-error">
                            <span class="due-date-display" aria-hidden="true">dd/mm/yyyy</span>
                            <div class="due-date-icon-container" aria-hidden="true">
                                <div class="due-date-icon"></div>
                            </div>
                        </div>
                        <span id="due-date-error" class="error-message" role="alert">This field is required</span>
                    </div>

                    <!-- PRIORITY -->
                    <div class="priority-container">
                        <div class="priority-header" id="priority-label">Priority</div>
                        <div class="priority-content" role="radiogroup" aria-labelledby="priority-label">
                            <button type="button" role="radio" aria-checked="false" class="priority-frame">
                                Urgent <img src="./assets/icons-addtask/Prio alta.svg" alt="">
                            </button>
                            <button type="button" role="radio" aria-checked="true" class="priority-frame active">
                                Medium <img src="./assets/icons-addtask/Capa 2.svg" alt="">
                            </button>
                            <button type="button" role="radio" aria-checked="false" class="priority-frame">
                                Low <img src="./assets/icons-addtask/Prio baja.svg" alt="">
                            </button>
                        </div>
                    </div>

                    <!-- ASSIGNED -->
                    <div class="assigned-container">
                        <div class="assigned-header">
                            <label for="assigned-input">Assigned to <span class="optional">(optional)</span></label>
                        </div>

                        <div class="assigned-content">
                            <div class="assigned-text-container">
                                <div class="assigned-text" id="assigned-label">Select contacts to assign</div>
                                <input type="text" class="assigned-input" id="assigned-input"
                                    aria-labelledby="assigned-label" role="combobox" aria-expanded="false"
                                    aria-controls="assigned-dropdown" autocomplete="off">
                            </div>

                            <div class="assigned-arrow-container" role="button" tabindex="0" aria-label="Toggle contacts dropdown">
                                <img id="assigned-arrow-icon" src="/assets/icons-addtask/arrow_drop_down.png" alt="" class="arrow-dropdown">
                            </div>

                            <div class="dropdown-menu" id="assigned-dropdown" role="listbox"></div>
                        </div>

                        <div class="selected-avatars-container" role="list"></div>
                    </div>

                    <!-- CATEGORY -->
                    <div class="category-container">
                        <div class="assigned-header">
                            <label for="category-input">Category</label>
                        </div>
                        <div class="category-content" role="combobox" aria-expanded="false" aria-controls="category-list">
                            <div class="assigned-text" id="category-label">Select task category</div>
                            <input type="text" id="category-input" class="visually-hidden" aria-labelledby="category-label">
                            <div class="assigned-arrow-container" role="button" tabindex="0" aria-label="Toggle category dropdown">
                                <img id="assigned-arrow-icon" src="/assets/icons-addtask/arrow_drop_down.png" alt="" class="arrow-dropdown">
                            </div>
                        </div>
                        <span class="error-message" id="category-error" role="alert">This field is required</span>
                    </div>

                    <!-- SUBTASKS -->
                    <div class="subtask-container">
                        <div class="assigned-header">
                            <label for="subtask-text">Subtasks <span class="optional">(optional)</span></label>
                        </div>

                        <div class="subtask-content-addtask">
                            <input type="text" id="subtask-text" class="subtask-text" placeholder="Add new subtask">
                            <div class="assigned-arrow-container">
                                <button id="cancel-btn" class="assigned-icon" aria-label="Cancel subtask">
                                    <img src="/assets/icons-addtask/cancel.png" alt="">
                                </button>
                                <button id="check-btn" class="assigned-icon" aria-label="Confirm subtask">
                                    <img src="/assets/icons-addtask/check.png" alt="">
                                </button>
                            </div>
                        </div>

                        <div id="task-dropdown" class="task-dropdown" role="listbox"></div>

                        <ul id="subtask-list" class="subtask-list" role="list"></ul>
                    </div>

                </div>

                <div class="button-container">
                    <button class="clear-btn" type="reset">Clear
                        <img src="./assets/icons-addtask/iconoir_cancel (1).png" alt="">
                    </button>
                    <button class="create-btn" id="create-btn" type="submit">
                        Create Task
                        <img src="./assets/icons-addtask/check (1).png" alt="">
                    </button>
                </div>
            </main>
        </div>

    </div>
    <!-- Landscape-Overlay -->
    <div class="lottie-background" id="landscape-overlay" role="dialog" aria-modal="true" 
        aria-labelledby="landscape-overlay-title" aria-hidden="true">

        <h2 id="landscape-overlay-title" class="visually-hidden">Landscape Mode Activated</h2>

        <dotlottie-wc src="https://lottie.host/995c5975-cad5-4553-955e-72e64e85e497/16Q1MEGlVj.lottie"
            class="lottie-animation" autoplay loop aria-hidden="true">
        </dotlottie-wc>
        
        <div id="landscape-status" class="visually-hidden" aria-live="assertive" aria-atomic="true"></div>
    </div>

    <script src="./scripts/auth.js"></script>
    <script src="./scripts/header.js"></script>
    <script>
        w3.includeHTML(() => {
            updateUserLogo();
            setActiveNavigation();
        });
    </script>
    <script src="./scripts/tasks-crud.js"></script>
    <script src="./scripts/addtask-main.js"></script>
    <script src="./scripts/addtask-validation.js"></script>
    <script src="./scripts/addtask-get-data.js"></script>
    <script src="./scripts/addtask-subtask.js"></script>
    


</body>

</html>