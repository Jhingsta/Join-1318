/* Verhindert Content-Flackern beim Seitenaufbau - spezifisch und stark */
html body {
    opacity: 0 !important;
}

/* Macht Body sichtbar sobald Animation läuft oder nicht nötig ist */
html body:not([data-summary-animate]),
html body[data-summary-animate="true"] {
    opacity: 1 !important;
}

/* Mobile: Content sofort verstecken (bevor Animation startet) */
@media (max-width: 768px) {
    html body .tasks-wrapper-grid {
        transform: translateY(100%) !important;
        opacity: 0 !important;
        transition: none !important; /* Kein Übergang beim ersten Verstecken */
    }
    
    /* Nur wenn Animation NICHT läuft: Content normal anzeigen */
    html body:not([data-summary-animate]) .tasks-wrapper-grid {
        transform: none !important;
        opacity: 1 !important;
    }
}

/* POST-LOGIN ANIMATION - CSS ONLY */
@media (max-width: 768px) {
    
    /* Keyframe Animation - steuert beide Phasen */
    @keyframes post-login-welcome {
        0% {
            /* Phase 1: Greeting zentriert, Content versteckt */
            --greeting-opacity: 1;
            --greeting-scale: 1;
            --content-transform: translateY(100%);
            --content-opacity: 0;
        }
        
        45% {
            /* Greeting noch voll sichtbar */
            --greeting-opacity: 1;
            --greeting-scale: 1;
            --content-transform: translateY(100%);
            --content-opacity: 0;
        }
        
        65% {
            /* Greeting beginnt zu verschwinden */
            --greeting-opacity: 0;
            --greeting-scale: 0.9;
            --content-transform: translateY(60%);
            --content-opacity: 0.3;
        }
        
        100% {
            /* Content vollständig sichtbar, Greeting weg */
            --greeting-opacity: 0;
            --greeting-scale: 0.8;
            --content-transform: translateY(0);
            --content-opacity: 1;
        }
    }

    /* Animation wird nur getriggert wenn data-post-login="true" */
    body[data-post-login="true"] {
        animation: post-login-welcome 4s ease-out forwards;
        
        /* CSS Custom Properties für Animation */
        --greeting-opacity: 1;
        --greeting-scale: 1;
        --content-transform: translateY(100%);
        --content-opacity: 0;
    }

    /* Greeting Styles während Animation */
    body[data-post-login="true"] .top-row {
        display: flex !important;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(var(--greeting-scale));
        z-index: 1000;
        opacity: var(--greeting-opacity);
        background: white;
    }

    /* Content Styles während Animation */
    body[data-post-login="true"] .tasks-wrapper-grid {
        transform: var(--content-transform);
        opacity: var(--content-opacity);
    }

    /* Nach Animation: Cleanup */
    body[data-post-login="true"] .top-row {
        animation: cleanup-greeting 0.1s ease-out 4s forwards;
    }

    @keyframes cleanup-greeting {
        to {
            display: none !important;
            position: static;
            transform: none;
            opacity: 0;
            z-index: auto;
        }
    }
    
    @keyframes cleanup-performance {
        to {
            will-change: auto;
            backface-visibility: visible;
            transition: none;
        }
    }
}

/* Desktop: Keine Animation */
@media (min-width: 769px) {
    body[data-post-login="true"] .top-row,
    body[data-post-login="true"] .tasks-wrapper-grid {
        animation: none !important;
        transform: none !important;
        opacity: 1 !important;
        position: static !important;
        z-index: auto !important;
    }
}